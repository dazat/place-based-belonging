# What is this Document for?

The purposes of this document are:

1.  to conduct a comprehensive analysis of place-based belonging data
2.  to provide a general reference and resource tool for higher education professionals who do things and make decisions about things that affect students (many of those things are tied to or rooted in physical places)
3.  to describe the development of methods used to generate place-based belonging data

[This document is currently under construction and is in a "good enough for now" state]{style="color: #11E8FF"}. It will be incrementally updated through Summer 2023, which will include adding Spring 2023 data. At that point, it will be considered complete, because we intend to augment methods dramatically the following year. Forthcoming sections include an overall summary, two content sections, and the supplemental method section. Forthcoming features include alternative text for plots and images and hover text for treemaps.

## What is Place-Based Belonging?

Over the last several years, we have been incrementally exploring the concept of place-based belonging: the idea that people's affinity for physical places, or lack thereof, is intertwined with their sense of whether they fit in socially. Theoretically, it is a special case of the environmental psychology concept of place attachment ([[Altman & Low, 1992](https://link.springer.com/chapter/10.1007/978-1-4684-8753-4_1){target="_blank"}]{style="color: #DF63A4"}), with conceptual focus on the place dimension over the person or process dimensions ([[Scannell & Gifford, 2010](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/EUOwgiMvl5pKonwqByWz8BoBkjCnPQk0VAw9mm1fzn3XfQ?e=WW9q1Z){target="_blank"}]{style="color: #DF63A4"}) and content focus on social meanings with which places are imbued as a subset of the general affective associations people have with places. Methodologically, it departs significantly from the psychometric approach of much place attachment research (e.g., [[Williams, 2014](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/EVGZxfZPNRlEoofpQI9UQz4BreUZgn5Z-W0Z7gVMNK7fdQ?e=xTznoC){target="_blank"}]{style="color: #DF63A4"}; [[Williams & Vaske, 2003](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/EVXdi_qf-_hPpRc_iruUoNwBJ1ma0fuw3ZHknWZWW2YAXQ?e=pVPMkt){target="_blank"}]{style="color: #DF63A4"}), aligning more closely with cultural mapping. Cultural mapping is an interdisciplinary field broadly tied together by a mode of inquiry and general methodology that reckons with documenting a community's place-based features and assets for a wide range of purposes. See [[Duxbury et al. (2015)](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/EQSU3UqGrw1GpScojaHKFVUBLiH2uuzMOtTlFmkpMoEr6w?e=jE9T38){target="_blank"}]{style="color: #DF63A4"} for an introduction and the [[whole book](https://www.routledge.com/Cultural-Mapping-as-Cultural-Inquiry/Duxbury-Garrett-Petts-MacLennan/p/book/9780367599003){target="_blank"}]{style="color: #DF63A4"} for varied perspectives. Place-based belonging, specifically, has roots in humanistic and cultural geography traditions, which feed into cultural mapping, and is depicted by a kind of symbol mapping ([[Soini, 2001](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/EVIw9hlo0LdGkCrxUpVFoYwBg__H3LRwrnGmUAavpQ1pRg?e=JyQV4u)]{style="color: #DF63A4"}).

Adapting methods from [<span style = "color: #DF63A4">Pitcher & Royal (2016)](https://uoregon-my.sharepoint.com/:b:/g/personal/clark13_uoregon_edu/ETDssdQ-bW1LsSA_db4aaVgBd_vO02wIffeQ_AqgQ3TgwQ?e=yBVY5o){target="_blank"}, we ask students to click up to three places on a campus map they feel like they "belong, fit in, are connected, are accepted, etc.," and separately, to click up to three places they feel like they "[do not]{style="color: #11E8FF"} belong, [do not]{style="color: #11E8FF"} fit in, are [dis]{style="color: #11E8FF"}connected, are [not]{style="color: #11E8FF"} accepted, etc." After clicking "belong" and "don't belong" places on a campus map, we follow up about select places to try and understand more about them. Generally, we ask students to describe in text why they feel the ways they do about the places. A unique aspect of follow-up involves delving into the Erb Memorial Union (EMU), which is a compact set of places, which cannot be disaggregated given a campus map and which form a unified place we call the EMU. If a student clicks on the EMU at the campus level, we follow up with a map of the EMU and ask them to click on places within the EMU they feel like they belong and don't belong, and then ask them to describe why. (Map and follow-up methods have varied over the years of development. See [[Supplemental Method](#supmeth)]{style="color: #DF63A4"} for more details.)

The methods above generate data that allow us to do several things:

-   describe a place and rank-order multiple places in terms of belong and don't belong sentiments
-   describe a place and rank-order multiple places in terms of inclusiveness, which is a combination of both belong and don't belong sentiments
-   disaggregate a place's inclusiveness by demographics
-   explore why places have belong or don't belong sentiments associated with them
-   describe how places relate to each other through belong and don't belong sentiments

## How to Read this Document

### Access

Other than our office or affiliated departments emailing or messaging individuals with the html document itself, it can be found at the Student Wellbeing and Success Initiative [[SharePoint site](https://uoregon.sharepoint.com/sites/SWaSI){target="_blank"}]{style="color: #DF63A4"} or [[OneDrive folder](https://uoregon-my.sharepoint.com/:f:/g/personal/reneedr_uoregon_edu/EvEnB12lziJEsktPwBpEmCYB33U133tkaLMlMSwC7UqmRg){target="_blank"}]{style="color: #DF63A4"}. If accessing this document from SharePoint, OneDrive, or Teams, for full functionality of document features, click "Download" in the ribbon at the top and then open with your browser. Microsoft products neither render table tabs nor open in-document links correctly. Your browser will, even in mobile formats.

### Focus

You need not read or even look at ***all*** of this document at any given time. You need not understand all of it the first time you look at it. You need not remember all of it no matter how many times you look at it. You will not be tested on it. It will be available for reference when you need it. And you can ask questions about it when they occur to you.

The document is generally geared toward exploring place-based belonging through visualization and description.

### Flow

```{r initial setup, include = FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(viridis)
library(reactable)
library(htmltools)
library(magick)
library(treemapify)
library(udpipe)
library(tidytext)
library(wordcloud2)
library(igraph)
library(ggraph)

ay_1<- 2122 #CHANGE year (academic year format 1920 etc.)
ay_2<- 2223 #CHANGE year (academic year format 1920 etc.)

#function for big Ns that have , marks
big_n<- function(x) {
  prettyNum(x, big.mark = ",", scientific = F)
}

#stats that get 1 decimal like percentages
stat_1<- function(x) {
  formatC(x, format = "f", digits = 1)
}

#get place names
places<- read_csv(here::here(
  paste0(
    "data/processed/pbb_eoy_1718_thru_",
    ay_1,
    "_places.csv"
  )
))

waves<- c("Spring 2022, Spring 2020, Spring 2019, Spring 2018") #CHANGE add waves as more data come in

```

There are six main sections after this one:

-   [[Summary](#summary)]{style="color: #DF63A4"}
    -   This section is forthcoming and will contain the overall take-home message. It will be the last section produced after other content sections are completed.
-   [[Where?](#where)]{style="color: #DF63A4"}
    -   This section contains interactive tables of place-based belonging metrics, heat maps of clicks on places, and treemaps and bar plots of place inclusiveness.
    -   It is organized hierarchically by three levels: 1. population (US undergraduate, international, graduate); 2. wave (`r waves`); 3. year in school (4th-year, 3rd-year, 2nd-year, 1st-year).
        -   Spring 2021 is missing due to remote operations during the pandemic.
        -   Heat maps include Spring 2017 but tables, treemaps, and bar plots do not because clicks were not yet quantified.
-   [[Why There?](#why)]{style="color: #DF63A4"}
    -   This section contains wordnets of adjacent adjective-noun pairs from, wordclouds of keywords from, and emotion classifications of students' descriptions of why they feel they ways they do about places.
    -   It is organized hierarchically by two levels: 1. population (US undergraduate, international, graduate); 2. place (Erb Memorial Union, Lokey Science Complex, and University Housing contain nested subordinate places for US undergraduates).
-   [[Where for Whom?](#whom)]{style="color: #DF63A4"}
    -   This section is forthcoming and will contain inclusiveness of popular places disaggregated by demographics.
-   [[Between Here and Where?](#between)]{style="color: #DF63A4"}
    -   This section is forthcoming and will contain networks of places based on "belong" and "don't belong" sentiments.
-   [[Supplemental Method](#supmeth)]{style="color: #DF63A4"}
    -   This section is forthcoming. It currently contains a Figure referenced in wordcloud notes and will contain detailed information about method development, procedure, and analysis. For now, methodological information is contained in notes.
    
```{r clicks setup, include = FALSE}

#read data ####

#get long campus data
campus_long<- read_csv(here::here(
  paste0(
    "data/processed/pbb_eoy_1718_thru_",
    ay_1,
    "_campus_bdb_long.csv"
  )
)) %>%
  left_join(
    .,
    places %>%
      filter(level == "campus"),
    by = c("ayear", "place")
  ) %>%
  within(cohort[is.na(cohort)]<- "no cohort") %>% #a trick to let me do the same function to data that are either cohort-specific or cohort-irrelevant
  within(
    full_place[
      full_place == "Thompsons"
    ]<- "Thompson's University Center"
  )

#get survey demos ####
#need to get gi and so from eoy when available, otherwise bl
#need to get others from bl data

#get recs demos ####
#need to add eoy22 who don't have bl to a set with bl

#combine above for doing analyses by demos ####
#join ds and dr to campus_long - reference bl wb by demos

#get emu long data
emu_long<- read_csv(here::here(
  paste0(
    "data/processed/pbb_eoy_1718_thru_",
    ay_1,
    "_emu_bdb_long.csv"
  )
)) %>%
  left_join(
    .,
    places %>%
      filter(level == "emu"),
    by = c("ayear", "place")
  ) %>%
  within(cohort[is.na(cohort)]<- "no cohort") %>%
  filter(
    place_num %in% c("b1", "b2", "b3", "db1", "db2", "db3")
  ) %>%
  within(
    full_place[
      full_place == "Craft Center - Outdoor"
    ]<- "Craft Center"
  )

#compute n resps > 3 (method was split across 2 maps in 1718 and 1819. students were instructed to select 3 but some selected more)
too_many_resps_emu<- read_csv(here::here(
  paste0(
    "data/processed/pbb_eoy_1718_thru_",
    ay_1,
    "_emu_bdb_wide.csv"
  )),
  guess_max = 1900
) %>%
  filter(
    !is.na(b4) |
      !is.na(db4)
  ) %>%
  group_by(ayear) %>%
  summarise(n = sum(!is.na(id)))

#combine above for doing analyses by demos ####
#join ds and dr to emu_long - reference bl wb by demos

#place counts and percentages ####

#function for getting n students
ns_fun<- function(dat, s_vec, c_vec, gt, lt) {
  df<- data.frame(
    bind_cols(
      dat %>%
        filter(
          sample %in% c(s_vec) &
            cohort %in% c(c_vec) &
            ayear > gt &
            ayear < lt &
            sent == "Belong" &
            some_place == "Some Place"
        ) %>%
        summarise(n_b = sum(!is.na(id) & !duplicated(id))),
      dat %>%
        filter(
          sample %in% c(s_vec) &
            cohort %in% c(c_vec) &
            ayear > gt &
            ayear < lt &
            sent == "Don't Belong" &
            some_place == "Some Place"
        ) %>%
        summarise(n_db = sum(!is.na(id) & !duplicated(id)))
    )
  )
  return(df)
}

#n clicks uses count dfs

#function for getting place counts
place_fun<- function(dat, s_vec, c_vec, gt, lt, p, by_p, n_dat) {
  df<- full_join(
    dat  %>%
      within(
        full_place[
          agg_place == "Other" |
            agg_place == "Out of Bounds"
        ]<- "Other/Out of Bounds"
      ) %>%
      within(
        agg_place[
          agg_place == "Other" |
            agg_place == "Out of Bounds"
        ]<- "Other/Out of Bounds"
      ) %>%
      filter(
        sample %in% c(s_vec) &
          cohort %in% c(c_vec) &
          ayear > gt &
          ayear < lt &
          sent == "Belong"
      ) %>%
      count(!!sym(p)) %>%
      arrange(desc(n)),
    dat %>%
      within(
        full_place[
          agg_place == "Other" |
            agg_place == "Out of Bounds"
        ]<- "Other/Out of Bounds"
      ) %>%
      within(
        agg_place[
          agg_place == "Other" |
            agg_place == "Out of Bounds"
        ]<- "Other/Out of Bounds"
      ) %>%
      filter(
        sample %in% c(s_vec) &
          cohort %in% c(c_vec) &
          ayear > gt &
          ayear < lt &
          sent == "Don't Belong"
      ) %>%
      count(!!sym(p)) %>%
      arrange(desc(n)),
    by = by_p
  ) %>%
    filter(!!sym(p) != "No Place") %>%
    rename(
      n_b = n.x,
      n_db = n.y
    ) %>%
    within(n_b[is.na(n_b)]<- 0) %>%
    within(n_db[is.na(n_db)]<- 0) %>%
    mutate(
      perc_click_b = n_b/sum(n_b)*100,
      perc_click_db = n_db/sum(n_db)*100,
      perc_stud_b = n_b/sum(n_dat$n_b)*100,
      perc_stud_db = n_db/sum(n_dat$n_db)*100,
      incl = n_b/(n_b+n_db)*100
    ) %>%
    select(!!sym(p), incl, n_b, n_db, everything())
  return(df)
}

#lt term in ns_fun, nw_fun, and place_fun for us undergrad overall and us undergrad by cohort sets
lt_term<- 2223 #CHANGE increment term as ayears are added

#function for making count label grobs to be put on maps
count_lab_fun<- function(df, n, sz, clr, loc) {
  img<- df %>%
    image_annotate(
      text = n,
      size = sz,
      font = "sans",
      color = clr,
      location = loc
    )
  return(img)
}

#make vectors for indexing ####
vnm_long<- names(campus_long) #same as emu_long

cohorts<- c(
  "0102",
  "0708",
  "1011",
  "1112",
  "1415",
  "1516",
  "1617",
  "1718",
  "1819",
  "1920",
  "2021",
  "2122",
  "2223"
  #CHANGE add cohorts as cohorts are added
)

classes<- c("Freshman", "Sophomore", "Junior", "Senior")

noco<- "no cohort"

vnm_pl<- c(
  "full_place",
  "incl",
  "n_b",
  "n_db",
  "perc_click_b",
  "perc_click_db",
  "perc_stud_b",
  "perc_stud_db"
)

#function for interactive datatables
reactable_fun<- function() {
  options(
    reactable.theme = reactableTheme(
      color = "hsl(233, 9%, 87%)",
      backgroundColor = "hsl(233, 9%, 19%)",
      borderColor = "hsl(233, 9%, 22%)",
      stripedColor = "hsl(233, 12%, 22%)",
      highlightColor = "hsl(233, 12%, 24%)",
      inputStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
      selectStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
      pageButtonHoverStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
      pageButtonActiveStyle = list(backgroundColor = "hsl(233, 9%, 28%)")
    )
  )
  rt<- bind_rows(
    pl_cam %>%
      left_join(
        .,
        places %>%
          filter(level == "campus") %>%
          select(full_place, agg_place),
        by = "full_place"
      ) %>%
      distinct(full_place, .keep_all = T) %>%
      mutate(
        incl = incl / 100,
        across(
          perc_click_b:perc_stud_db, ~.x / 100
        )
      ) %>%
      within(
        full_place[
          full_place == "Jordan Schnitzer Museum of Art"
        ]<- "J. Schnitzer Museum of Art"
      ) %>%
      within(
        full_place[
          full_place == "Thompson's University Center"
        ]<- "Thompson's Univ Center"
      ) %>%
      within(
        full_place[
          full_place == "Museum of Natural and Cultural History"
        ]<- "Museum of Nat & Cult Hist"
      ) %>%
      within(
        full_place[
          full_place == "Campus Planning and Facilities Management"
        ]<- "Campus Plan & Facil Mgmt"
      ) %>%
      within(
        agg_place[
          agg_place == "Jordan Schnitzer Museum of Art"
        ]<- "J. Schnitzer Museum of Art"
      ) %>%
      within(
        agg_place[
          agg_place == "Museum of Natural and Cultural History"
        ]<- "Museum of Nat & Cult Hist"
      ) %>%
      within(
        agg_place[
          agg_place == "Campus Planning and Facilities Management"
        ]<- "Campus Plan & Facil Mgmt"
      ) %>%
      within(
        agg_place[
          agg_place == "Student Recreation Complex"
        ]<- "Student Rec Complex"
      ) %>%
      within(
        agg_place[
          agg_place == "Thompson's University Center"
        ]<- "Thompson's Univ Center"
      ) %>%
      within(
        agg_place[
          is.na(agg_place)
        ]<- "Other/Out of Bounds"
      ),
    pl_emu %>%
      left_join(
        .,
        places %>%
          filter(level == "emu") %>%
          select(full_place, agg_place),
        by = "full_place"
      ) %>%
      distinct(full_place, .keep_all = T) %>%
      mutate(
        incl = incl / 100,
        across(
          perc_click_b:perc_stud_db, ~.x / 100
        ),
        agg_place = "EMU-Specific Places"
      ) %>%
      within(
        full_place[
          full_place == "ASUO Student Governance Center"
        ]<- "ASUO Stdnt Gov Cntr"
      ) %>%
      within(
        full_place[
          full_place == "Bartolotti's Pizza Bistro"
        ]<- "Bartolotti's Pizza"
      ) %>%
      within(
        full_place[
          full_place == "Center for Student Involvement Resource Center"
        ]<- "CSI Resource Center"
      ) %>%
      within(
        full_place[
          full_place == "Collegiate Recover Center"
        ]<- "Collegiate Recovery Cntr"
      ) %>%
      within(
        full_place[
          full_place == "Falling Sky Pizzeria and Public House"
        ]<- "Falling Sky"
      ) %>%
      within(
        full_place[
          full_place == "Fraternity and Sorority Life"
        ]<- "Fraternity & Sorority Life"
      ) %>%
      within(
        full_place[
          full_place == "International Student Association"
        ]<- "Intl Stdnt Assoc"
      ) %>%
      within(
        full_place[
          full_place == "International Student Groups"
        ]<- "Intl Stdnt Groups"
      ) %>%
      within(
        full_place[
          full_place == "Legal Services Student Advocacy"
        ]<- "Legal Srvc Stdnt Advocacy"
      ) %>%
      within(
        full_place[
          full_place == "Nontraditional Student Union"
        ]<- "Nontrad Stdnt Union"
      ) %>%
      within(
        full_place[
          full_place == "Scheduling and Event Services"
        ]<- "Sched & Event Services"
      ) %>%
      within(
        full_place[
          full_place == "Student Sustainability Center"
        ]<- "Stdnt Sustainability Cntr"
      )
  ) %>%
    reactable(
      .,
      groupBy = "agg_place",
      showPageSizeOptions = T,
      paginateSubRows = T,
      defaultSorted = c("agg_place", "full_place"),
      sortable = T,
      showSortable = T,
      striped = T,
      highlight = T,
      bordered = T,
      defaultColDef = colDef(
        vAlign = "center",
        headerVAlign = "bottom"
      ),
      columns = list(
        agg_place = colDef(
          name = "Aggregated Place",
          filterable = T,
          align = "left",
          minWidth = 240
        ),
        full_place = colDef(
          name = "Place",
          align = "left",
          minWidth = 215
        ),
        n_b = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(separators = T, digits = 0),
          html = T,
          header = JS(
            'function(column) {
              return `<div style="font-style: italic">n</div>` + "Belong"
            }'
          )
        ),
        n_db = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(separators = T, digits = 0),
          html = T,
          header = JS(
            'function(column) {
              return `<div style="font-style: italic">n</div>` + "Don\'t" +
              "<br>Belong"
            }'
          )
        ),
        perc_click_b = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(percent = T, digits = 1),
          html = T,
          header = JS(
            'function(column) {
              return "Click" + "<br>Belong"
            }'
          )
        ),
        perc_click_db = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(percent = T, digits = 1),
          html = T,
          header = JS(
            'function(column) {
              return "Click" + "<br>Don\'t" + "<br>Belong"
            }'
          )
        ),
        perc_stud_b = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(percent = T, digits = 1),
          html = T,
          header = JS(
            'function(column) {
              return "Student" + "<br>Belong"
            }'
          )
        ),
        perc_stud_db = colDef(
          aggregate = "sum",
          align = "center",
          format = colFormat(percent = T, digits = 1),
          html = T,
          header = JS(
            'function(column) {
              return "Student" + "<br>Don\'t" + "<br>Belong"
            }'
          )
        ),
        incl = colDef(
          aggregate = "mean",
          name = "Inclusive",
          align = "center",
          format = colFormat(percent = T, digits = 1)
        )
      )
    )
  return(rt)
}

#function for inclusiveness treemaps
inclusive_tree_fun_1<- function(df) {
  sub<- df %>%
    mutate(tot = n_b + n_db) %>%
    filter(tot > 19) %>%
    filter(
      !(
        str_detect(full_place, "Lawn") |
          str_detect(full_place, "Other") |
          str_detect(full_place, "Bounds")
      )
    ) %>%
    mutate(
      place = case_when(
        str_detect(full_place, "Prince") ~ "PLC",
        str_detect(full_place, "Fenton") ~ "Fent",
        str_detect(full_place, "LERC") ~ "MS",
        str_detect(full_place, "Esslinger") ~ "Essl",
        full_place == "Cascade" ~ "Cas",
        str_detect(full_place, "Moss") ~ "Moss",
        str_detect(full_place, "Black") ~ "BCC",
        str_detect(full_place, "McArthur") ~ "Mac",
        str_detect(full_place, "Friendly") ~ "Friend",
        str_detect(full_place, "Saunders") ~ "Saun Stad",
        full_place == "Tennis Indoor" ~ "TI",
        str_detect(full_place, "Fine") ~ "FAS",
        str_detect(full_place, "Turf Field 1") ~ "TF1",
        str_detect(full_place, "History") ~ "MN CH",
        str_detect(full_place, "Turf Field 3") ~ "TF3",
        str_detect(full_place, "Duck") ~ "DS",
        str_detect(full_place, "Longhouse") ~ "MNL",
        str_detect(full_place, "Program Barn") ~ "Barn",
        str_detect(full_place, "Straub/Earl") ~ "Straub/ Earl",
        str_detect(full_place, "Center South") ~ "LLC South",
        #all of the above too few to represent full label in small rectangle
        #for us undergrad overall and with the exception of PLC these places
        #don't affect other treemaps and PLC needs abbreviation in the others
        TRUE ~ full_place
      )
    ) %>%
    group_by(place) %>%
    summarise(
      incl = mean(incl),
      tot = sum(tot)
    )
  cp<- as.vector(
    if_else(sub$incl > 75, "#30313A", "#FCFFA4")
  )
  plot<- sub %>%
    ggplot(
      .,
      aes(
        area = tot,
        fill = incl,
        label = place
      )
    ) +
    geom_treemap() +
    geom_treemap_text(
      place = "center",
      grow = T,
      reflow = T,
      color = cp
    ) +
    scale_fill_viridis_c(
      name = "Inclusiveness",
      option = "inferno",
      limits = c(0, 100)
    ) +
    theme(
      panel.background = element_rect(fill = "#30313A"),
      plot.background = element_rect(color = "#30313A", fill = "#30313A"),
      legend.background = element_rect(fill = "#30313A"),
      legend.title = element_text(color = "#FCFFA4"),
      legend.text = element_text(color = "#FCFFA4"),
      plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm")
      #top, right, bottom, left, units
    )
  return(plot)
}

inclusive_tree_fun_2<- function(df) {
  sub<- df %>%
    mutate(tot = n_b + n_db) %>%
    filter(tot > 19) %>%
    filter(
      !(
        str_detect(full_place, "Other") |
          str_detect(full_place, "Bounds")
      )
    ) %>%
    group_by(full_place) %>%
    summarise(
      incl = mean(incl),
      tot = sum(tot)
    )
  cp<- as.vector(
    if_else(sub$incl > 75, "#30313A", "#FCFFA4")
  )
  plot<- sub %>%
    ggplot(
      .,
      aes(
        area = tot,
        fill = incl,
        label = full_place
      )
    ) +
    geom_treemap() +
    geom_treemap_text(
      place = "center",
      grow = T,
      reflow = T,
      color = cp
    ) +
    scale_fill_viridis_c(
      name = "Inclusiveness",
      option = "inferno",
      limits = c(0, 100)
    ) +
    theme(
      panel.background = element_rect(fill = "#30313A"),
      plot.background = element_rect(color = "#30313A", fill = "#30313A"),
      legend.background = element_rect(fill = "#30313A"),
      legend.title = element_text(color = "#FCFFA4"),
      legend.text = element_text(color = "#FCFFA4"),
      plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm")
      #top, right, bottom, left, units
    )
  return(plot)
}

#function for inclusiveness bar plots
inclusive_bar_fun<- function(df, nc, b_cp, e_cp) {
  plot<- df %>%
    filter(
      !(
        str_detect(agg_place, "Lawn") |
          str_detect(agg_place, "Other") |
          str_detect(agg_place, "Bounds")
      )
    ) %>%
    mutate(
      tot_prop_click = (n_b + n_db) /
        ((nc$n_b + nc$n_db) / 2)
    ) %>%
    filter(tot_prop_click >= 0.1) %>%
    mutate(
      agg_place = factor(agg_place),
      agg_place = fct_reorder(agg_place, incl)
    ) %>%
    ggplot(
      .,
      aes(
        x = agg_place,
        y = incl,
        fill = agg_place
      )
    ) +
    geom_bar(
      stat = "identity",
      position = "dodge"
    ) +
    xlab("") +
    ylab("Inclusiveness") +
    scale_y_continuous(
      breaks = c(0, 25, 50, 75, 100),
      limits = c(0, 125)
    ) +
    scale_fill_viridis_d(
      option = "inferno",
      begin = b_cp,
      end = e_cp
    ) +
    coord_flip() +
    geom_text(
      aes(label = sprintf("%0.1f", incl)),
      hjust = -0.5,
      size = 5,
      color = "#FCFFA4"
    ) +
    guides(fill = "none") +
    theme(
      panel.background = element_rect(fill = "#30313A"),
      plot.background = element_rect(color = "#30313A", fill = "#30313A"),
      panel.grid = element_blank(),
      axis.title = element_text(size = 13, color = "#FCFFA4", hjust = 0.375),
      axis.text = element_text(size = 12, color = "#FCFFA4"),
      axis.ticks.y = element_blank()
    )
  return(plot)
}

```

```{r campus clicks, include = FALSE}

#object label abbreviations
#agg = aggregated
#ay = academic year
#c = cohort
#cam = campus
#emu = emu
#i = international
#gr = graduate
#nc = number of clicks
#ns = number of students
#nw = number of waves students contributed data (for overall only)
#pl = place
#rt = reactable
#ug = undergraduate
#us = united states
#vec = vector

#us undergrad overall ####

#n student
ns_cam_us_ug<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  lt_term
)

ns_emu_us_ug<- ns_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1617,
  lt_term
)

#n waves
nw_cam_us_ug<- campus_long %>%
  filter(
    sample == "us ug" &
    cohort %in% c(cohorts, noco) &
    ayear > 1617 &
    ayear < lt_term
  ) %>% 
  group_by(id) %>%
  count(ayear) %>%
  ungroup() %>%
  count(id) %>%
  rename(n_waves = n) %>%
  count(n_waves)

nw_emu_us_ug<- emu_long %>%
  filter(
    sample == "us ug" &
    cohort %in% c(cohorts, noco) &
    ayear > 1617 &
    ayear < lt_term
  ) %>% 
  group_by(id) %>%
  count(ayear) %>%
  ungroup() %>%
  count(id) %>%
  rename(n_waves = n) %>%
  count(n_waves)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  lt_term,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1617,
  lt_term,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug
)

#n click
nc_cam_us_ug<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  lt_term,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug
)

#reactable for place count and perc
rt_cam_us_ug<- reactable_fun()

#inclusiveness treemap
tree_cam_us_ug<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug<- pl_emu %>%
  within(
    full_place[
      full_place == "Student Sustainability Center"
    ]<- "SSC"
  ) %>%
  inclusive_tree_fun_2()

#inclusiveness bar plot
ibar_cam_us_ug<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug,
  0.404,
  0.840
)

#international overall ####

#n student
ns_cam_i<- ns_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(classes, cohorts, noco),
  1617,
  lt_term
)

ns_emu_i<- ns_fun(
  emu_long,
  c("intl ug", "intl gr"),
  c(classes, cohorts, noco),
  1617,
  lt_term
)

#n waves
nw_cam_i<- campus_long %>%
  filter(
    sample %in% c("intl ug", "intl gr") &
    cohort %in% c(cohorts, classes, noco) &
    ayear > 1617 &
    ayear < lt_term
  ) %>% 
  group_by(id) %>%
  count(ayear) %>%
  ungroup() %>%
  count(id) %>%
  rename(n_waves = n) %>%
  count(n_waves)

nw_emu_i<- emu_long %>%
  filter(
    sample %in% c("intl ug", "intl gr") &
    cohort %in% c(cohorts, classes, noco) &
    ayear > 1617 &
    ayear < lt_term
  ) %>% 
  group_by(id) %>%
  count(ayear) %>%
  ungroup() %>%
  count(id) %>%
  rename(n_waves = n) %>%
  count(n_waves)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(classes, cohorts, noco),
  1617,
  lt_term,
  vnm_long[13],
  "full_place",
  ns_cam_i
)

pl_emu<- place_fun(
  emu_long,
  c("intl ug", "intl gr"),
  c(classes, cohorts, noco),
  1617,
  lt_term,
  vnm_long[13],
  "full_place",
  ns_emu_i
)

#reactable for place count and perc
rt_cam_i<- reactable_fun()

#n click
nc_cam_i<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_i<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(classes, cohorts, noco),
  1617,
  lt_term,
  vnm_long[14],
  "agg_place",
  ns_cam_i
)

#inclusiveness treemap
tree_cam_i<- inclusive_tree_fun_1(pl_cam)
#tree_emu_i<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_i<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_i,
  0.514,
  0.886
)

#us undergrad by ayear ####

#n student
ns_cam_us_ug_ay1617<- data.frame(
  n_b = 261,
  n_db = 234
)

#ay1617
map_cam_b_us_ug_ay1617<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1617.png")
)

#ay1617
map_cam_db_us_ug_ay1617<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1617.png")
)

#ay1718

#n student
ns_cam_us_ug_ay1718<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  1819
)

ns_emu_us_ug_ay1718<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  1819
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  1819,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1718
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1617,
  1819,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1718
)

#n click
nc_cam_us_ug_ay1718<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1718<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1617,
  1819,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1718
)

#reactable for place count and perc
rt_cam_us_ug_ay1718<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1718<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1718.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 15, "yellow", "+323+180") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 15, "blue", "+334+244") %>% #src
  count_lab_fun(pl_lab_vec[3], 15, "blue", "+230+232") %>% #libary
  count_lab_fun(pl_lab_vec[4], 15, "blue", "+345+138") %>% #lokey
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[5], 15, "blue", "+237+142") %>% #lillis
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[7], 15, "blue", "+476+246") %>% #gsh
  count_lab_fun(pl_lab_vec[8], 15, "blue", "+347+212") %>% #straub/earl
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[9], 15, "blue", "+303+116") %>% #lawrence
  count_lab_fun(pl_lab_vec[10], 15, "blue", "+437+183") %>% #hamilton
  count_lab_fun(pl_lab_vec[11], 15, "blue", "+371+210") %>% #llc
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[12], 15, "blue", "+295+130") %>% #allen
  count_lab_fun(pl_lab_vec[13], 15, "blue", "+545+34") %>% #autzen
  count_lab_fun(pl_lab_vec[14], 15, "blue", "+496+177") %>% #matt knight
  count_lab_fun(pl_lab_vec[15], 15, "blue", "+225+106") %>% #mckenzie
  count_lab_fun(pl_lab_vec[16], 15, "blue", "+227+308") %>% #frohnmayer
  image_crop("627x353+1+3")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1718.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1718.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1718<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+615+345") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 25, "blue", "+827+495") %>% #courtyard
  count_lab_fun(pl_lab_vec[3], 25, "blue", "+260+547") %>% #craft
  count_lab_fun(pl_lab_vec[5], 25, "blue", "+589+1010") %>% #taylor
  count_lab_fun(pl_lab_vec[6], 25, "blue", "+528+122") %>% #womens
  count_lab_fun(pl_lab_vec[7], 25, "blue", "+271+378") %>% #olounge
  count_lab_fun(pl_lab_vec[8], 25, "blue", "+85+365") %>% #fallingsky
  count_lab_fun(pl_lab_vec[9], 25, "blue", "+1080+81") %>% #mcc
  count_lab_fun(pl_lab_vec[10], 25, "yellow", "+377+763") #mills

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1718<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1718.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 15, "yellow", "+335+244") %>% #src
  count_lab_fun(pl_lab_vec[5], 15, "yellow", "+237+141") %>% #lillis
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[12], 15, "yellow", "+395+257") %>% #hayward
  count_lab_fun(pl_lab_vec[4], 15, "blue", "+345+138") %>% #lokey
  #mapping wasn't disaggregated yet
  count_lab_fun(pl_lab_vec[13], 15, "yellow", "+430+146") %>% #jaqua
  count_lab_fun(pl_lab_vec[1], 15, "blue", "+326+182") %>% #emu
  count_lab_fun(pl_lab_vec[3], 15, "blue", "+235+232") %>% #libary
  count_lab_fun(pl_lab_vec[8], 15, "blue", "+547+35") %>% #autzen
  count_lab_fun(pl_lab_vec[9], 15, "blue", "+496+177") %>% #matt knight
  count_lab_fun(pl_lab_vec[11], 15, "blue", "+430+252") %>% #law
  count_lab_fun(pl_lab_vec[10], 15, "blue", "+227+306") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[7], 15, "blue", "+476+248") %>% #gsh
  image_crop("627x353+1+3")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1718.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1718.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1718<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+610+345") #fishbowl

#inclusiveness treemap
tree_cam_us_ug_ay1718<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1718<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1718<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1718,
  0.453,
  0.827
)

#ay1819

#n student
ns_cam_us_ug_ay1819<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1718,
  1920
)

ns_emu_us_ug_ay1819<- ns_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1718,
  1920
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1819
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1819
)

#n click
nc_cam_us_ug_ay1819<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1819<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1718,
  1920,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1819
)

#reactable for place count and perc
rt_cam_us_ug_ay1819<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1819<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1819.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 22, "yellow", "+466+265") %>% #emu
  count_lab_fun(pl_agg_lab_vec[4], 22, "blue", "+488+388") %>% #src
  count_lab_fun(pl_lab_vec[2], 22, "blue", "+287+363") %>% #libary
  count_lab_fun(pl_agg_lab_vec[5], 22, "blue", "+501+184") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[6], 22, "blue", "+298+191") %>% #lillis comp
  count_lab_fun(pl_lab_vec[6], 22, "blue", "+428+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[7], 22, "blue", "+687+265") %>% #hamilton
  count_lab_fun(pl_lab_vec[8], 22, "blue", "+499+320") %>% #straub
  count_lab_fun(pl_lab_vec[9], 22, "blue", "+762+395") %>% #gsh
  count_lab_fun(pl_lab_vec[10], 22, "blue", "+234+456") %>% #hedco
  count_lab_fun(pl_lab_vec[11], 22, "blue", "+412+170") %>% #allen
  count_lab_fun(pl_lab_vec[12], 22, "blue", "+615+198") %>% #oregon
  count_lab_fun(pl_lab_vec[13], 22, "blue", "+273+125") %>% #mckenzie
  count_lab_fun(pl_lab_vec[14], 22, "blue", "+282+505") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[16], 22, "blue", "+746+322") %>% #bean
  count_lab_fun(pl_lab_vec[17], 22, "blue", "+562+247") %>% #carson
  count_lab_fun(pl_lab_vec[18], 22, "blue", "+754+470") %>% #kalapuya
  count_lab_fun(pl_lab_vec[19], 22, "blue", "+608+315") %>% #walton
  count_lab_fun(pl_lab_vec[20], 22, "blue", "+805+260") %>% #matt knight
  count_lab_fun(pl_lab_vec[22], 22, "blue", "+622+244") %>% #uhs
  count_lab_fun("?", 30, "red", "+953+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1819.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1819.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1819<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+618+360") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 25, "blue", "+273+400") %>% #olounge
  count_lab_fun(pl_lab_vec[3], 25, "blue", "+528+140") %>% #womens
  count_lab_fun(pl_lab_vec[4], 25, "blue", "+829+509") %>% #courtyard
  count_lab_fun(pl_lab_vec[6], 25, "blue", "+1080+95") %>% #mcc
  count_lab_fun(pl_lab_vec[7], 25, "blue", "+258+565") %>% #craft
  count_lab_fun(pl_lab_vec[8], 25, "blue", "+594+1011") %>% #taylor
  count_lab_fun(pl_lab_vec[9], 25, "blue", "+119+534") %>% #ducknest
  count_lab_fun(pl_lab_vec[10], 25, "blue", "+85+377") %>% #fallingsky
  count_lab_fun(pl_lab_vec[11], 25, "blue", "+505+195") %>% #atriumeast
  count_lab_fun(pl_lab_vec[12], 25, "yellow", "+385+765") %>% #mills
  count_lab_fun(pl_lab_vec[13], 25, "blue", "+783+92") #duckstore

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1819<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1819.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[4], 22, "yellow", "+488+388") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 22, "blue", "+291+191") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[5], 22, "blue", "+505+183") %>% #lokey comp
  count_lab_fun(pl_lab_vec[16], 22, "blue", "+673+202") %>% #jaqua
  count_lab_fun(pl_lab_vec[11], 22, "blue", "+800+262") %>% #matt knight
  count_lab_fun(pl_lab_vec[15], 22, "blue", "+605+415") %>% #hayward
  count_lab_fun(pl_lab_vec[2], 22, "blue", "+296+362") %>% #libary
  count_lab_fun(pl_lab_vec[1], 22, "blue", "+473+265") %>% #emu
  count_lab_fun(pl_lab_vec[13], 22, "blue", "+678+402") %>% #law
  count_lab_fun(pl_lab_vec[7], 22, "blue", "+762+395") %>% #gsh
  count_lab_fun(pl_lab_vec[10], 22, "blue", "+754+470") %>% #kalapuya
  count_lab_fun(pl_lab_vec[8], 22, "blue", "+282+505") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[14], 22, "blue", "+372+460") %>% #cemetery
  count_lab_fun(pl_lab_vec[6], 22, "blue", "+687+265") %>% #hamilton
  count_lab_fun("?", 30, "red", "+955+144") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1819.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1819.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1819<- image_append(maps, stack = T)
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay1819<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1819<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1819<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1819,
  0.409,
  0.865
)

#ay1920

#n student
ns_cam_us_ug_ay1920<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1819,
  2021
)

ns_emu_us_ug_ay1920<- ns_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1920
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1920
)

#n click
nc_cam_us_ug_ay1920<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1920<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1920
)

#reactable for place count and perc
rt_cam_us_ug_ay1920<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1920<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1920.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+460+274") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+484+394") %>% #src
  count_lab_fun(pl_lab_vec[3], 18, "yellow", "+280+371") %>% #libary
  count_lab_fun(pl_agg_lab_vec[5], 18, "blue", "+498+187") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[7], 18, "blue", "+283+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+948+155") %>% #autzen
  count_lab_fun(pl_lab_vec[6], 18, "blue", "+682+275") %>% #hamilton
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+421+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+740+331") %>% #bean
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+760+405") %>% #gsh
  count_lab_fun(pl_lab_vec[10], 18, "blue", "+407+175") %>% #allen
  count_lab_fun(pl_lab_vec[11], 18, "blue", "+497+335") %>% #straub
  count_lab_fun(pl_lab_vec[12], 18, "blue", "+274+515") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[13], 18, "blue", "+795+270") %>% #matt knight
  count_lab_fun(pl_lab_vec[14], 18, "blue", "+751+481") %>% #kalapuya
  count_lab_fun(pl_lab_vec[15], 18, "blue", "+340+252") %>% #tykeson
  count_lab_fun(pl_lab_vec[17], 18, "blue", "+556+254") %>% #carson
  count_lab_fun(pl_lab_vec[18], 18, "blue", "+610+202") %>% #oregon
  count_lab_fun(pl_lab_vec[19], 18, "blue", "+225+470") %>% #hedco
  count_lab_fun(pl_lab_vec[20], 18, "blue", "+317+245") %>% #chapman
  count_lab_fun(pl_lab_vec[22], 18, "blue", "+265+130") %>% #mckenzie
  count_lab_fun(pl_lab_vec[23], 18, "blue", "+603+325") %>% #walton
  count_lab_fun(pl_lab_vec[24], 18, "blue", "+617+255") %>% #uhs
  count_lab_fun(pl_lab_vec[29], 18, "blue", "+364+465") %>% #cemetery
  count_lab_fun(pl_lab_vec[30], 18, "blue", "+319+305") %>% #jsma
  count_lab_fun(pl_lab_vec[32], 18, "blue", "+668+412") #law

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay1920<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay1920.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+290+420") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+315+180") %>% #green
  count_lab_fun(pl_lab_vec[3], 18, "blue", "+192+197") %>% #olounge
  count_lab_fun(pl_lab_vec[4], 18, "yellow", "+330+51") %>% #womens
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+404+497") %>% #courtyard
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+184+284") %>% #craft
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+537+279") %>% #mcc
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+85+182") %>% #fallingsky
  count_lab_fun(pl_lab_vec[10], 18, "blue", "+315+83") %>% #atriumeast
  count_lab_fun(pl_lab_vec[11], 18, "blue", "+379+350") %>% #taylor
  count_lab_fun(pl_lab_vec[12], 18, "blue", "+104+266") %>% #ducknest
  count_lab_fun(pl_lab_vec[13], 18, "blue", "+495+129") %>% #mills
  count_lab_fun(pl_lab_vec[14], 18, "blue", "+38+142") %>% #fishterr
  count_lab_fun(pl_lab_vec[15], 18, "blue", "+154+122") %>% #freshmarket
  count_lab_fun(pl_lab_vec[16], 18, "blue", "+384+56") %>% #lgbtqa3
  count_lab_fun(pl_lab_vec[17], 18, "blue", "+378+277") #duckstore

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1920<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1920.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+486+394") %>% #src
  count_lab_fun(pl_agg_lab_vec[7], 18, "yellow", "+284+196") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[5], 18, "blue", "+502+189") %>% #lokey comp
  count_lab_fun(pl_lab_vec[22], 18,  "blue", "+590+431") %>% #hayward
  count_lab_fun(pl_lab_vec[1], 18, "blue", "+463+275") %>% #emu
  count_lab_fun(pl_lab_vec[3], 18, "blue", "+285+371") %>% #libary
  count_lab_fun(pl_lab_vec[23], 18,  "blue", "+667+208") %>% #jaqua
  count_lab_fun(pl_lab_vec[12], 18, "blue", "+798+270") %>% #matt knight
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+950+156") %>% #autzen
  count_lab_fun(pl_lab_vec[21], 18,  "blue", "+671+412") %>% #law
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+759+402") %>% #gsh
  count_lab_fun(pl_lab_vec[6], 18, "blue", "+682+272") %>% #hamilton
  count_lab_fun(pl_lab_vec[20], 18, "blue", "+366+472") %>% #cemetery
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+421+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[11], 18, "blue", "+274+510") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[15], 18, "blue", "+227+468") %>% #hedco
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+740+331") %>% #bean
  count_lab_fun(pl_lab_vec[13], 18, "blue", "+751+481") %>% #kalapuya
  count_lab_fun(pl_lab_vec[10], 18, "blue", "+407+175") %>% #allen
  count_lab_fun(pl_lab_vec[16], 18, "blue", "+265+130") #mckenzie

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay1920<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay1920.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+403+499")#courtyard

#inclusiveness treemap
tree_cam_us_ug_ay1920<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1920<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1920<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1920,
  0.426,
  0.864
)

#ay2122

#n student
ns_cam_us_ug_ay2122<- ns_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  2021,
  2223
)

ns_emu_us_ug_ay2122<- ns_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay2122
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay2122
)

#n click
nc_cam_us_ug_ay2122<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay2122<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay2122
)

#reactable for place count and perc
rt_cam_us_ug_ay2122<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay2122<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay2122.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+458+272") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+485+391") %>% #src
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+279+368") %>% #libary
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+493+184") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[6], 21, "blue", "+282+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+949+152") %>% #autzen
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+677+328") %>% #unthank
  count_lab_fun(pl_lab_vec[7], 21, "blue", "+416+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[8], 21, "blue", "+224+466") %>% #hedco
  count_lab_fun(pl_lab_vec[9], 21, "blue", "+495+326") %>% #straub
  count_lab_fun(pl_lab_vec[10], 21, "blue", "+758+398") %>% #gsh
  count_lab_fun(pl_lab_vec[11], 21, "blue", "+263+128") %>% #mckenzie
  count_lab_fun(pl_lab_vec[12], 21, "blue", "+740+331") %>% #bean
  count_lab_fun(pl_lab_vec[13], 21, "blue", "+340+252") %>% #tykeson
  count_lab_fun(pl_lab_vec[15], 21, "blue", "+404+175") %>% #allen
  count_lab_fun(pl_lab_vec[17], 21, "blue", "+271+508") %>% #frohnmayer
  count_lab_fun(pl_lab_vec[19], 21, "blue", "+365+473") %>% #cemetery
  count_lab_fun(pl_lab_vec[20], 21, "blue", "+680+269") %>% #hamilton
  count_lab_fun(pl_lab_vec[21], 21, "blue", "+750+478") %>% #kalapuya
  count_lab_fun(pl_lab_vec[23], 21, "blue", "+610+202") %>% #oregon
  count_lab_fun(pl_lab_vec[24], 21, "blue", "+514+336") %>% #earl
  count_lab_fun(pl_lab_vec[25], 21, "blue", "+795+266") %>% #matt knight
  count_lab_fun(pl_lab_vec[26], 21, "blue", "+315+243") %>% #chapman
  count_lab_fun(pl_lab_vec[27], 21, "blue", "+613+249") %>% #uhs
  count_lab_fun(pl_lab_vec[28], 21, "blue", "+556+254") %>% #carson
  count_lab_fun(pl_lab_vec[29], 21,  "blue", "+593+431") %>% #hayward
  count_lab_fun(pl_lab_vec[30], 21, "blue", "+263+250") #condon

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay2122<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay2122.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+287+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+309+179") %>% #green
  count_lab_fun(pl_lab_vec[4], 21, "blue", "+402+494") %>% #courtyard
  count_lab_fun(pl_lab_vec[5], 21, "yellow", "+330+48") %>% #womens
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+536+276") %>% #mcc
  count_lab_fun(pl_lab_vec[7], 21, "blue", "+183+285") %>% #craft
  count_lab_fun(pl_lab_vec[8], 21, "blue", "+178+188") %>% #olounge
  count_lab_fun(pl_lab_vec[9], 21, "blue", "+383+53") %>% #lgbtqa3
  count_lab_fun(pl_lab_vec[10], 21, "blue", "+493+128") %>% #mills
  count_lab_fun(pl_lab_vec[11], 21, "blue", "+37+142") %>% #fishterr
  count_lab_fun(pl_lab_vec[12], 21, "blue", "+379+350") %>% #taylor
  count_lab_fun(pl_lab_vec[13], 21, "blue", "+85+180") %>% #bartolotti
  count_lab_fun(pl_lab_vec[14], 21, "blue", "+104+266") %>% #ducknest
  count_lab_fun(pl_lab_vec[15], 21, "blue", "+58+31") %>% #amphitheater
  count_lab_fun(pl_lab_vec[16], 21, "blue", "+314+82") #atriumeast

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay2122<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay2122.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+484+393") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 21, "yellow", "+283+195") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+493+184") %>% #lokey comp
  count_lab_fun(pl_lab_vec[17], 21,  "blue", "+587+430") %>% #hayward
  count_lab_fun(pl_lab_vec[1], 21, "blue", "+458+272") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "blue", "+285+366") %>% #libary
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+947+155") %>% #autzen
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+677+328") %>% #unthank
  count_lab_fun(pl_lab_vec[15], 21, "blue", "+795+269") %>% #matt knight
  count_lab_fun(pl_lab_vec[18], 21, "blue", "+671+412") %>% #law
  count_lab_fun(pl_lab_vec[20], 21, "blue", "+589+123") %>% #knight camp
  count_lab_fun(pl_lab_vec[19], 21, "blue", "+667+208") %>% #jaqua
  count_lab_fun(pl_lab_vec[7], 21, "blue", "+758+398") %>% #gsh
  count_lab_fun(pl_lab_vec[12], 21, "blue", "+361+473") %>% #cemetery
  count_lab_fun(pl_lab_vec[13], 21, "blue", "+740+331") %>% #bean
  count_lab_fun(pl_lab_vec[8], 21, "blue", "+680+269") %>% #hamilton
  count_lab_fun(pl_lab_vec[14], 21, "blue", "+613+249") %>% #uhs
  count_lab_fun(pl_lab_vec[10], 21, "blue", "+271+508") #frohnmayer

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay2122<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay2122.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "blue", "+398+494") #courtyard

#inclusiveness treemap
tree_cam_us_ug_ay2122<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay2122<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay2122<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay2122,
  0.359,
  0.801
)

#us undergrad by ayear and cohort ####

#ay1819, c1516

#n student
ns_cam_us_ug_ay1819_c1516<- ns_fun(
  campus_long,
  "us ug",
  1516,
  1718,
  1920
)

ns_emu_us_ug_ay1819_c1516<- ns_fun(
  emu_long,
  "us ug",
  1516,
  1718,
  1920
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1516,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1819_c1516
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1516,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1819_c1516
)

#n click
nc_cam_us_ug_ay1819_c1516<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1819_c1516<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1516,
  1718,
  1920,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1819_c1516
)

#reactable for place count and perc
rt_cam_us_ug_ay1819_c1516<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1819_c1516<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1819_c1516.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 22, "yellow", "+470+263") %>% #emu
  count_lab_fun(pl_agg_lab_vec[2], 22, "blue", "+497+384") %>% #src
  count_lab_fun(pl_lab_vec[3], 22, "blue", "+292+362") %>% #library
  count_lab_fun("?", 30, "red", "+953+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1819_c1516.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1819_c1516.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1819_c1516<- image_append(maps, stack = T)
#insufficient data

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1819_c1516<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1819_c1516.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[1], 22, "blue", "+496+387") %>% #src
  count_lab_fun(pl_agg_lab_vec[2], 22, "blue", "+300+190") %>% #lillis comp
  count_lab_fun("?", 30, "red", "+955+142") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1819_c1516.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1819_c1516.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1819_c1516<- image_append(maps, stack = T)
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay1819_c1516<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay1819_c1516<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay1819_c1516<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1819_c1516,
  0.400,
  0.852
)

#ay1819, c1617

#n student
ns_cam_us_ug_ay1819_c1617<- ns_fun(
  campus_long,
  "us ug",
  1617,
  1718,
  1920
)

ns_emu_us_ug_ay1819_c1617<- ns_fun(
  emu_long,
  "us ug",
  1617,
  1718,
  1920
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1617,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1819_c1617
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1617,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1819_c1617
)

#n click
nc_cam_us_ug_ay1819_c1617<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1819_c1617<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1617,
  1718,
  1920,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1819_c1617
)

#reactable for place count and perc
rt_cam_us_ug_ay1819_c1617<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1819_c1617<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1819_c1617.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 22, "yellow", "+473+264") %>% #emu
  count_lab_fun(pl_lab_vec[2], 22, "blue", "+295+363") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 22, "blue", "+497+384") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 22, "blue", "+300+190") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[5], 22, "blue", "+501+182") %>% #lokey comp
  count_lab_fun("?", 30, "red", "+953+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1819_c1617.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1819_c1617.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1819_c1617<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+618+360") #fishbowl

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1819_c1617<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1819_c1617.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[2], 22, "blue", "+300+191") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[3], 22, "blue", "+511+184") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 22, "blue", "+674+201") %>% #jaqua
  count_lab_fun(pl_agg_lab_vec[1], 22, "blue", "+497+384") %>% #src
  count_lab_fun("?", 30, "red", "+955+142") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1819_c1617.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1819_c1617.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1819_c1617<- image_append(maps, stack = T)
#insufficient data for counts on an emu don't belong map

#inclusiveness treemap
tree_cam_us_ug_ay1819_c1617<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay1819_c1617<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay1819_c1617<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1819_c1617,
  0.379,
  0.928
)

#ay1819, c1718

#n student
ns_cam_us_ug_ay1819_c1718<- ns_fun(
  campus_long,
  "us ug",
  1718,
  1718,
  1920
)

ns_emu_us_ug_ay1819_c1718<- ns_fun(
  emu_long,
  "us ug",
  1718,
  1718,
  1920
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1718,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1819_c1718
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1718,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1819_c1718
)

#n click
nc_cam_us_ug_ay1819_c1718<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1819_c1718<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1718,
  1718,
  1920,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1819_c1718
)

#reactable for place count and perc
rt_cam_us_ug_ay1819_c1718<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1819_c1718<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1819_c1718.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 22, "yellow", "+471+266") %>% #emu
  count_lab_fun(pl_lab_vec[2], 22, "blue", "+296+362") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 22, "blue", "+506+181") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[4], 22, "blue", "+495+386") %>% #src
  count_lab_fun("?", 30, "red", "+953+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1819_c1718.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1819_c1718.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1819_c1718<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+618+360") #fishbowl

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1819_c1718<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1819_c1718.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[2], 22, "yellow", "+498+388") %>% #src
  count_lab_fun(pl_agg_lab_vec[3], 22, "yellow", "+298+189") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[1], 22, "blue", "+514+182") %>% #lokey comp
  count_lab_fun("?", 30, "red", "+955+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1819_c1718.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1819_c1718.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1819_c1718<- image_append(maps, stack = T)

#inclusiveness treemap
tree_cam_us_ug_ay1819_c1718<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay1819_c1718<- inclusive_tree_fun_2(pl_emu)
#insufficient data 

#inclusiveness bar plot
ibar_cam_us_ug_ay1819_c1718<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1819_c1718,
  0.396,
  0.889
)

#ay1819, c1819

#n student
ns_cam_us_ug_ay1819_c1819<- ns_fun(
  campus_long,
  "us ug",
  1819,
  1718,
  1920
)

ns_emu_us_ug_ay1819_c1819<- ns_fun(
  emu_long,
  "us ug",
  1819,
  1718,
  1920
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1819,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1819_c1819
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1819,
  1718,
  1920,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1819_c1819
)

#n click
nc_cam_us_ug_ay1819_c1819<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1819_c1819<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1819,
  1718,
  1920,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1819_c1819
)

#reactable for place count and perc
rt_cam_us_ug_ay1819_c1819<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1819_c1819<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1819_c1819.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 22, "yellow", "+465+266") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 22, "yellow", "+496+387") %>% #src
  count_lab_fun(pl_lab_vec[3], 22, "blue", "+295+362") %>% #library
  count_lab_fun(pl_agg_lab_vec[5], 22, "blue", "+508+183") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 22, "blue", "+687+265") %>% #hamilton
  count_lab_fun(pl_agg_lab_vec[6], 22, "blue", "+298+189") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 22, "blue", "+762+395") %>% #gsh
  count_lab_fun(pl_lab_vec[8], 22, "blue", "+746+322") %>% #bean
  count_lab_fun(pl_lab_vec[9], 22, "blue", "+562+247") %>% #carson
  count_lab_fun(pl_lab_vec[10], 22, "blue", "+754+470") %>% #kalapuya
  count_lab_fun(pl_lab_vec[11], 22, "blue", "+499+320") %>% #straub
  count_lab_fun(pl_lab_vec[12], 22, "blue", "+615+198") %>% #oregon
  count_lab_fun("?", 30, "red", "+953+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/b_map_emu1_us_ug_ay1819_c1819.png")
  ),
  image_read(here::here(
    "images/pbb/b_map_emu2_us_ug_ay1819_c1819.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_b_us_ug_ay1819_c1819<- image_append(maps, stack = T) %>%
  count_lab_fun(pl_lab_vec[1], 25, "yellow", "+620+363") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 25, "blue", "+273+400") %>% #olounge
  count_lab_fun(pl_lab_vec[3], 25, "yellow", "+528+140") %>% #womens
  count_lab_fun(pl_lab_vec[4], 25, "blue", "+830+509") %>% #courtyard
  count_lab_fun(pl_lab_vec[5], 25, "blue", "+1083+97") %>% #mcc
  count_lab_fun(pl_lab_vec[7], 25, "blue", "+119+534") #ducknest

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1819_c1819<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1819_c1819.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 22, "yellow", "+496+387") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 22, "blue", "+299+189") %>% #lillis comp
  count_lab_fun(pl_lab_vec[10], 22, "blue", "+673+201") %>% #jaqua
  count_lab_fun(pl_lab_vec[3], 22, "blue", "+295+362") %>% #library
  count_lab_fun(pl_lab_vec[1], 22, "blue", "+471+267") %>% #emu
  count_lab_fun(pl_lab_vec[8], 22, "blue", "+800+262") %>% #matt knight
  count_lab_fun(pl_agg_lab_vec[5], 22, "blue", "+508+183") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 22, "blue", "+762+395") %>% #gsh
  count_lab_fun(pl_lab_vec[7], 22, "blue", "+754+470") %>% #kalapuya
  count_lab_fun(pl_lab_vec[9], 22, "blue", "+605+415") %>% #hayward
  count_lab_fun("?", 30, "red", "+955+140") %>% #autzen
  image_crop("1075x605+1")

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

maps<- c(
  image_read(here::here(
    "images/pbb/db_map_emu1_us_ug_ay1819_c1819.png")
  ),
  image_read(here::here(
    "images/pbb/db_map_emu2_us_ug_ay1819_c1819.png")
  )
) %>%
  image_scale(., "1280x1170")

map_emu_db_us_ug_ay1819_c1819<- image_append(maps, stack = T)

#inclusiveness treemap
tree_cam_us_ug_ay1819_c1819<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1819_c1819<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1819_c1819<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1819_c1819,
  0.512,
  0.856
)

#ay1920, c1617

#n student
ns_cam_us_ug_ay1920_c1617<- ns_fun(
  campus_long,
  "us ug",
  1617,
  1819,
  2021
)

ns_emu_us_ug_ay1920_c1617<- ns_fun(
  emu_long,
  "us ug",
  1617,
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1617,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1920_c1617
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1617,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1920_c1617
)

#n click
nc_cam_us_ug_ay1920_c1617<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1920_c1617<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1617,
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1920_c1617
)

#reactable for place count and perc
rt_cam_us_ug_ay1920_c1617<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1920_c1617<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1920_c1617.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+465+274") %>% #emu
  count_lab_fun(pl_agg_lab_vec[2], 18, "yellow", "+490+393") %>% #src
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+287+372") %>% #library
  count_lab_fun(pl_agg_lab_vec[4], 18, "blue", "+503+187") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[5], 18, "blue", "+289+195") #lillis comp

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay1920_c1617<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay1920_c1617.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+295+420") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+321+180") #green

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1920_c1617<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1920_c1617.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+291+195") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[2], 18, "blue", "+509+189") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[1], 18, "blue", "+492+393") #src

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay1920_c1617<- image_read(here::here(
  "images/pbb/db_map_emu_us_ug_ay1920_c1617.png")
)
#insufficient data 

#inclusiveness treemap
tree_cam_us_ug_ay1920_c1617<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay1920_c1617<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay1920_c1617<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1920_c1617,
  0.387,
  0.910
)

#ay1920, c1718

#n student
ns_cam_us_ug_ay1920_c1718<- ns_fun(
  campus_long,
  "us ug",
  1718,
  1819,
  2021
)

ns_emu_us_ug_ay1920_c1718<- ns_fun(
  emu_long,
  "us ug",
  1718,
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1718,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1920_c1718
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1718,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1920_c1718
)

#n click
nc_cam_us_ug_ay1920_c1718<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1920_c1718<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1718,
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1920_c1718
)

#reactable for place count and perc
rt_cam_us_ug_ay1920_c1718<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1920_c1718<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1920_c1718.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+465+274") %>% #emu
  count_lab_fun(pl_lab_vec[2], 18, "blue", "+284+371") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 18, "blue", "+490+393") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 18, "blue", "+503+190") #lokey comp

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay1920_c1718<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay1920_c1718.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+294+419") #fishbowl

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1920_c1718<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1920_c1718.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[2], 18, "blue", "+290+197") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[1], 18, "blue", "+492+392") #src

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay1920_c1718<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay1920_c1718.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay1920_c1718<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay1920_c1718<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay1920_c1718<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1920_c1718,
  0.371,
  0.909
)

#ay1920, c1819

#n student
ns_cam_us_ug_ay1920_c1819<- ns_fun(
  campus_long,
  "us ug",
  1819,
  1819,
  2021
)

ns_emu_us_ug_ay1920_c1819<- ns_fun(
  emu_long,
  "us ug",
  1819,
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1819,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1920_c1819
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1819,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1920_c1819
)

#n click
nc_cam_us_ug_ay1920_c1819<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1920_c1819<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1819,
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1920_c1819
)

#reactable for place count and perc
rt_cam_us_ug_ay1920_c1819<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1920_c1819<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1920_c1819.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+459+274") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+491+394") %>% #src
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+280+371") %>% #library
  count_lab_fun(pl_agg_lab_vec[4], 18, "blue", "+500+182") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[6], 18, "blue", "+290+197") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+953+154") %>% #autzen
  count_lab_fun(pl_lab_vec[6], 18, "blue", "+496+334") %>% #straub
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+421+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+405+176") #allen

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay1920_c1819<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay1920_c1819.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+293+419") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+320+180") %>% #green
  count_lab_fun(pl_lab_vec[3], 18, "yellow", "+330+51") %>% #womens
  count_lab_fun(pl_lab_vec[4], 18, "blue", "+192+197") %>% #olounge
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+406+495") #courtyard

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1920_c1819<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1920_c1819.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+491+394") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 18, "yellow", "+290+197") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[4], 18, "blue", "+509+190") %>% #lokey comp
  count_lab_fun(pl_lab_vec[1], 18, "blue", "+462+275") %>% #emu
  count_lab_fun(pl_lab_vec[6], 18, "blue", "+795+270") %>% #matt knight
  count_lab_fun(pl_lab_vec[8], 18,  "blue", "+597+434") %>% #hayward
  count_lab_fun(pl_lab_vec[2], 18, "blue", "+286+371") %>% #library
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+667+207") %>% #jaqua
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+951+156") %>% #autzen
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+671+413") #law

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay1920_c1819<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay1920_c1819.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay1920_c1819<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1920_c1819<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1920_c1819<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1920_c1819,
  0.408,
  0.820
)

#ay1920, c1920

#n student
ns_cam_us_ug_ay1920_c1920<- ns_fun(
  campus_long,
  "us ug",
  1920,
  1819,
  2021
)

ns_emu_us_ug_ay1920_c1920<- ns_fun(
  emu_long,
  "us ug",
  1920,
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1920,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay1920_c1920
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1920,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay1920_c1920
)

#n click
nc_cam_us_ug_ay1920_c1920<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay1920_c1920<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1920,
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay1920_c1920
)

#reactable for place count and perc
rt_cam_us_ug_ay1920_c1920<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay1920_c1920<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay1920_c1920.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+459+274") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+484+394") %>% #src
  count_lab_fun(pl_lab_vec[3], 18, "blue", "+287+371") %>% #library
  count_lab_fun(pl_lab_vec[4], 18, "blue", "+683+273") %>% #hamilton
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+740+333") %>% #bean
  count_lab_fun(pl_lab_vec[6], 18, "blue", "+952+156") %>% #autzen
  count_lab_fun(pl_agg_lab_vec[6], 18, "blue", "+503+190") %>% #lokey comp
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+758+402") %>% #gsh
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+421+138") %>% #lawrence
  count_lab_fun(pl_agg_lab_vec[7], 18, "blue", "+294+197") %>% #lillis comp
  count_lab_fun(pl_lab_vec[10], 18, "blue", "+751+481") %>% #kalapuya
  count_lab_fun(pl_lab_vec[11], 18, "blue", "+556+254") %>% #carson
  count_lab_fun(pl_lab_vec[12], 18, "blue", "+603+325") %>% #walton
  count_lab_fun(pl_lab_vec[13], 18, "blue", "+795+270") %>% #matt knight
  count_lab_fun(pl_lab_vec[14], 18, "blue", "+497+335") %>% #straub
  count_lab_fun(pl_lab_vec[15], 18, "blue", "+340+252") %>% #tykeson
  count_lab_fun(pl_lab_vec[16], 18, "blue", "+274+515") #frohnmayer

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay1920_c1920<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay1920_c1920.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+297+420") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 18, "yellow", "+321+181") %>% #green
  count_lab_fun(pl_lab_vec[3], 18, "yellow", "+192+197") %>% #olounge
  count_lab_fun(pl_lab_vec[4], 18, "yellow", "+330+51") %>% #womens
  count_lab_fun(pl_lab_vec[5], 18, "yellow", "+185+286") %>% #craft
  count_lab_fun(pl_lab_vec[6], 18, "yellow", "+537+279") %>% #mcc
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+404+497") %>% #courtyard
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+315+83") %>% #atriumeast
  count_lab_fun(pl_lab_vec[10], 18, "blue", "+87+182") %>% #fallingsky
  count_lab_fun(pl_lab_vec[11], 18, "blue", "+105+267") #ducknest

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay1920_c1920<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay1920_c1920.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 18, "yellow", "+491+395") %>% #src
  count_lab_fun(pl_agg_lab_vec[7], 18, "yellow", "+291+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[3], 18, "blue", "+286+372") %>% #library
  count_lab_fun(pl_lab_vec[1], 18, "blue", "+463+274") %>% #emu
  count_lab_fun(pl_lab_vec[10], 18,  "blue", "+594+434") %>% #hayward
  count_lab_fun(pl_agg_lab_vec[6], 18, "blue", "+503+190") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 18, "blue", "+951+156") %>% #autzen
  count_lab_fun(pl_lab_vec[8], 18, "blue", "+798+270") %>% #matt knight
  count_lab_fun(pl_lab_vec[5], 18, "blue", "+758+402") %>% #gsh
  count_lab_fun(pl_lab_vec[9], 18, "blue", "+672+411") %>% #law
  count_lab_fun(pl_lab_vec[7], 18, "blue", "+749+482") #kalapuya

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay1920_c1920<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay1920_c1920.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay1920_c1920<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay1920_c1920<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay1920_c1920<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay1920_c1920,
  0.439,
  0.875
)

#ay2122, c1819

#n student
ns_cam_us_ug_ay2122_c1819<- ns_fun(
  campus_long,
  "us ug",
  1819,
  2021,
  2223
)

ns_emu_us_ug_ay2122_c1819<- ns_fun(
  emu_long,
  "us ug",
  1819,
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1819,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay2122_c1819
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1819,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay2122_c1819
)

#n click
nc_cam_us_ug_ay2122_c1819<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay2122_c1819<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1819,
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay2122_c1819
)

#reactable for place count and perc
rt_cam_us_ug_ay2122_c1819<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay2122_c1819<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay2122_c1819.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+459+270") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+280+364") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+485+389") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 21, "blue", "+494+182") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+284+196") #lillis comp

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay2122_c1819<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay2122_c1819.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+317+179") #green

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay2122_c1819<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay2122_c1819.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[1], 21, "yellow", "+488+392") %>% #src
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+288+195") %>% #lillis comp
  count_lab_fun(pl_agg_lab_vec[2], 21, "blue", "+503+189") %>% #lokey comp
  count_lab_fun(pl_lab_vec[3], 21, "blue", "+595+428") #hayward

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay2122_c1819<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay2122_c1819.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay2122_c1819<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay2122_c1819<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay2122_c1819<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay2122_c1819,
  0.345,
  0.823
)

#ay2122, c1920

#n student
ns_cam_us_ug_ay2122_c1920<- ns_fun(
  campus_long,
  "us ug",
  1920,
  2021,
  2223
)

ns_emu_us_ug_ay2122_c1920<- ns_fun(
  emu_long,
  "us ug",
  1920,
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  1920,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay2122_c1920
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  1920,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay2122_c1920
)

#n click
nc_cam_us_ug_ay2122_c1920<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay2122_c1920<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  1920,
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay2122_c1920
)

#reactable for place count and perc
rt_cam_us_ug_ay2122_c1920<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay2122_c1920<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay2122_c1920.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+452+270") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+280+364") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+485+389") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 21, "blue", "+492+181") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+285+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+940+150") #autzen

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay2122_c1920<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay2122_c1920.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+317+179") %>% #green
  count_lab_fun(pl_lab_vec[3], 21, "blue", "+330+48") #womens

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay2122_c1920<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay2122_c1920.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[1], 21, "yellow", "+488+391") %>% #src
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+289+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+593+429") %>% #hayward
  count_lab_fun(pl_lab_vec[1], 21, "blue", "+464+271") %>% #emu
  count_lab_fun(pl_agg_lab_vec[2], 21, "blue", "+502+189") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 21, "blue", "+795+266") #matt knight

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay2122_c1920<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay2122_c1920.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay2122_c1920<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay2122_c1920<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay2122_c1920<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay2122_c1920,
  0.337,
  0.829
)

#ay2122, c2021

#n student
ns_cam_us_ug_ay2122_c2021<- ns_fun(
  campus_long,
  "us ug",
  2021,
  2021,
  2223
)

ns_emu_us_ug_ay2122_c2021<- ns_fun(
  emu_long,
  "us ug",
  2021,
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  2021,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay2122_c2021
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  2021,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay2122_c2021
)

#n click
nc_cam_us_ug_ay2122_c2021<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay2122_c2021<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  2021,
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay2122_c2021
)

#reactable for place count and perc
rt_cam_us_ug_ay2122_c2021<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay2122_c2021<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay2122_c2021.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+464+272") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+284+368") %>% #library
  count_lab_fun(pl_agg_lab_vec[2], 21, "yellow", "+490+392") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 21, "blue", "+497+184") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[6], 21, "blue", "+287+197") %>% #lillis comp
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+224+466") #hedco

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay2122_c2021<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay2122_c2021.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+317+179") #green

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay2122_c2021<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay2122_c2021.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[2], 21, "yellow", "+489+393") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 21, "yellow", "+289+195") %>% #lillis comp
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+595+429") %>% #hayward
  count_lab_fun(pl_lab_vec[1], 21, "blue", "+465+272") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "blue", "+285+367") %>% #library
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+949+152") %>% #autzen
  count_lab_fun(pl_agg_lab_vec[4], 21, "blue", "+503+189") #lokey comp

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay2122_c2021<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay2122_c2021.png")
  ) 
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay2122_c2021<- inclusive_tree_fun_1(pl_cam)
#tree_emu_us_ug_ay2122_c2021<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_us_ug_ay2122_c2021<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay2122_c2021,
  0.333,
  0.778
)

#ay2122, c2122

#n student
ns_cam_us_ug_ay2122_c2122<- ns_fun(
  campus_long,
  "us ug",
  2122,
  2021,
  2223
)

ns_emu_us_ug_ay2122_c2122<- ns_fun(
  emu_long,
  "us ug",
  2122,
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "us ug",
  2122,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_us_ug_ay2122_c2122
)

pl_emu<- place_fun(
  emu_long,
  "us ug",
  2122,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_us_ug_ay2122_c2122
)

#n click
nc_cam_us_ug_ay2122_c2122<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_us_ug_ay2122_c2122<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "us ug",
  2122,
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_us_ug_ay2122_c2122
)

#reactable for place count and perc
rt_cam_us_ug_ay2122_c2122<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_us_ug_ay2122_c2122<- image_read(here::here(
  "images/pbb/b_map_cam_us_ug_ay2122_c2122.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+458+272") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+483+392") %>% #src
  count_lab_fun(pl_lab_vec[3], 21, "yellow", "+284+368") %>% #library
  count_lab_fun(pl_lab_vec[4], 21, "blue", "+677+328") %>% #unthank
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+496+184") %>% #lokey comp
  count_lab_fun(pl_lab_vec[5], 21, "blue", "+757+398") %>% #gsh
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+740+329") %>% #bean
  count_lab_fun(pl_agg_lab_vec[6], 21, "blue", "+286+197") %>% #lillis comp
  count_lab_fun(pl_lab_vec[8], 21, "blue", "+949+152") %>% #autzen
  count_lab_fun(pl_lab_vec[9], 21, "blue", "+680+269") %>% #hamilton
  count_lab_fun(pl_lab_vec[10], 21, "blue", "+750+478") %>% #kalapuya
  count_lab_fun(pl_lab_vec[11], 21, "blue", "+416+138") %>% #lawrence
  count_lab_fun(pl_lab_vec[12], 21, "blue", "+263+128") %>% #mckenzie
  count_lab_fun(pl_lab_vec[13], 21, "blue", "+515+331") #earl

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_us_ug_ay2122_c2122<- image_read(here::here(
    "images/pbb/b_map_emu_us_ug_ay2122_c2122.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+293+416") %>% #fishbowl
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+316+179") %>% #green
  count_lab_fun(pl_lab_vec[3], 21, "blue", "+402+494") %>% #courtyard
  count_lab_fun(pl_lab_vec[4], 21, "blue", "+183+283") #craft

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_us_ug_ay2122_c2122<- image_read(here::here(
  "images/pbb/db_map_cam_us_ug_ay2122_c2122.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[3], 21, "yellow", "+481+392") %>% #src
  count_lab_fun(pl_agg_lab_vec[6], 21, "yellow", "+288+196") %>% #lillis comp
  count_lab_fun(pl_lab_vec[7], 21, "blue", "+594+429") %>% #hayward
  count_lab_fun(pl_lab_vec[1], 21, "blue", "+464+272") %>% #emu
  count_lab_fun(pl_lab_vec[3], 21, "blue", "+284+368") %>% #library
  count_lab_fun(pl_lab_vec[4], 21, "blue", "+677+328") %>% #unthank
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+505+189") %>% #lokey comp
  count_lab_fun(pl_lab_vec[6], 21, "blue", "+949+152") %>% #autzen
  count_lab_fun(pl_lab_vec[8], 21, "blue", "+669+410") #law

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_us_ug_ay2122_c2122<- image_read(here::here(
    "images/pbb/db_map_emu_us_ug_ay2122_c2122.png")
  )
#insufficient data

#inclusiveness treemap
tree_cam_us_ug_ay2122_c2122<- inclusive_tree_fun_1(pl_cam)
tree_emu_us_ug_ay2122_c2122<- inclusive_tree_fun_2(pl_emu)

#inclusiveness bar plot
ibar_cam_us_ug_ay2122_c2122<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_us_ug_ay2122_c2122,
  0.417,
  0.819
)

#international undergrad 1920 ####

#n student
ns_cam_i_ug_ay1920<- ns_fun(
  campus_long,
  "intl ug",
  classes,
  1819,
  2021
)

ns_emu_i_ug_ay1920<- ns_fun(
  emu_long,
  "intl ug",
  classes,
  1819,
  2021
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  "intl ug",
  classes,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_cam_i_ug_ay1920
)

pl_emu<- place_fun(
  emu_long,
  "intl ug",
  classes,
  1819,
  2021,
  vnm_long[13],
  "full_place",
  ns_emu_i_ug_ay1920
)

#n click
nc_cam_i_ug_ay1920<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_i_ug_ay1920<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  "intl ug",
  classes,
  1819,
  2021,
  vnm_long[14],
  "agg_place",
  ns_cam_i_ug_ay1920
)

#reactable for place count and perc
rt_cam_i_ug_ay1920<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_i_ug_ay1920<- image_read(here::here(
  "images/pbb/b_map_cam_i_ug_ay1920.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 21, "yellow", "+462+270") %>% #emu
  count_lab_fun(pl_lab_vec[2], 21, "yellow", "+284+369") %>% #library
  count_lab_fun(pl_agg_lab_vec[3], 21, "blue", "+501+187") %>% #lokey comp
  count_lab_fun(pl_agg_lab_vec[5], 21, "blue", "+489+390") #src comp

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_i_ug_ay1920<- image_read(here::here(
    "images/pbb/b_map_emu_i_ug_ay1920.png")
  ) %>%
  count_lab_fun(pl_lab_vec[1], 18, "yellow", "+496+130") #mills

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_i_ug_ay1920<- image_read(here::here(
  "images/pbb/db_map_cam_i_ug_ay1920.png")
)
#insufficient data

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_i_ug_ay1920<- image_read(here::here(
  "images/pbb/db_map_emu_i_ug_ay1920.png")
)
#insufficient data

#inclusiveness treemap
tree_cam_i_ug_ay1920<- inclusive_tree_fun_1(pl_cam)
#tree_emu_i_ug_ay1920<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_i_ug_ay1920<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_i_ug_ay1920,
  0.478,
  0.895
)

#international undergrad and grad 2122 ####

#n student
ns_cam_i_ay2122<- ns_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(cohorts, noco),
  2021,
  2223
)

ns_emu_i_ay2122<- ns_fun(
  emu_long,
  c("intl ug", "intl gr"),
  c(cohorts, noco),
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_i_ay2122
)

pl_emu<- place_fun(
  emu_long,
  c("intl ug", "intl gr"),
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_i_ay2122
)

#n click
nc_cam_i_ay2122<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_i_ay2122<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  c("intl ug", "intl gr"),
  c(cohorts, noco),
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_i_ay2122
)

#reactable for place count and perc
rt_cam_i_ay2122<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_i_ay2122<- image_read(here::here(
  "images/pbb/b_map_cam_i_ay2122.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 24, "yellow", "+462+270") #emu

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_i_ay2122<- image_read(here::here(
  "images/pbb/b_map_emu_i_ay2122.png")
)
#insufficient data

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

map_cam_db_i_ay2122<- image_read(here::here(
  "images/pbb/db_map_cam_i_ay2122.png")
)
#insufficient data

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_i_ay2122<- image_read(here::here(
  "images/pbb/db_map_emu_i_ay2122.png")
)
#insufficient data

#inclusiveness treemap
#tree_cam_i_ay2122<- inclusive_tree_fun_1(pl_cam)
#tree_emu_i_ay2122<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_i_ay2122<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_i_ay2122,
  0.200,
  0.871
)

#us and international grad ####

#ay2122

#n student
ns_cam_gr_ay2122<- ns_fun(
  campus_long,
  c("us gr", "intl gr"),
  noco,
  2021,
  2223
)

ns_emu_gr_ay2122<- ns_fun(
  emu_long,
  c("us gr", "intl gr"),
  noco,
  2021,
  2223
)

#place count and perc
pl_cam<- place_fun(
  campus_long,
  c("us gr", "intl gr"),
  noco,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_cam_gr_ay2122
)

pl_emu<- place_fun(
  emu_long,
  c("us gr", "intl gr"),
  noco,
  2021,
  2223,
  vnm_long[13],
  "full_place",
  ns_emu_gr_ay2122
)

#n click
nc_cam_gr_ay2122<- data.frame(
  n_b = sum(pl_cam$n_b),
  n_db = sum(pl_cam$n_db)
)

nc_emu_gr_ay2122<- data.frame(
  n_b = sum(pl_emu$n_b),
  n_db = sum(pl_emu$n_db)
)

#aggregated place count and perc
pl_cam_agg<- place_fun(
  campus_long,
  c("us gr", "intl gr"),
  noco,
  2021,
  2223,
  vnm_long[14],
  "agg_place",
  ns_cam_gr_ay2122
)

#reactable for place count and perc
rt_cam_gr_ay2122<- reactable_fun()

#belong map
pl_lab_vec<- pl_cam$n_b[pl_cam$n_b > 19]

pl_agg_lab_vec<- pl_cam_agg$n_b[pl_cam_agg$n_b > 19]

map_cam_b_gr_ay2122<- image_read(here::here(
  "images/pbb/b_map_cam_gr_ay2122.png")
) %>%
  count_lab_fun(pl_lab_vec[1], 24, "yellow", "+278+363") %>% #library
  count_lab_fun(pl_lab_vec[2], 24, "yellow", "+455+268") %>% #emu
  count_lab_fun(pl_agg_lab_vec[3], 24, "blue", "+479+383") %>% #src
  count_lab_fun(pl_agg_lab_vec[4], 24, "blue", "+495+181") %>% #lokey comp
  count_lab_fun(pl_lab_vec[4], 24, "blue", "+220+464") #hedco

pl_lab_vec<- pl_emu$n_b[pl_emu$n_b > 19]

map_emu_b_gr_ay2122<- image_read(here::here(
  "images/pbb/b_map_emu_gr_ay2122.png")
)
#insufficient data

#don't belong map
pl_lab_vec<- pl_cam$n_db[pl_cam$n_db > 19]

pl_agg_lab_vec<- pl_cam_agg$n_db[pl_cam_agg$n_db > 19]

map_cam_db_gr_ay2122<- image_read(here::here(
  "images/pbb/db_map_cam_gr_ay2122.png")
) %>%
  count_lab_fun(pl_agg_lab_vec[2], 24, "yellow", "+486+391") %>% #src
  count_lab_fun(pl_lab_vec[1], 24, "yellow", "+457+270") #emu

pl_lab_vec<- pl_emu$n_db[pl_emu$n_db > 19]

map_emu_db_gr_ay2122<- image_read(here::here(
  "images/pbb/db_map_emu_gr_ay2122.png")
)
#insufficient data

#inclusiveness treemap
tree_cam_gr_ay2122<- inclusive_tree_fun_1(pl_cam)
#tree_emu_gr_ay2122<- inclusive_tree_fun_2(pl_emu)
#insufficient data

#inclusiveness bar plot
ibar_cam_gr_ay2122<- inclusive_bar_fun(
  pl_cam_agg,
  nc_cam_gr_ay2122,
  0.462,
  0.878
)

```
